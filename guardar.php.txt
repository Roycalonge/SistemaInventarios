<?php
require 'vendor/autoload.php';

use PhpOffice\PhpSpreadsheet\IOFactory;

$archivoExcel = "TodoPerfumes.xlsx"; 
$spreadsheet = IOFactory::load($archivoExcel);

if (isset($_POST['cambios'])) {
    $cambios = json_decode($_POST['cambios'], true);

    foreach ($cambios as $cambio) {
        $hoja = $spreadsheet->getSheet($cambio['hoja']);
        $hoja->setCellValue($cambio['columna'] . $cambio['fila'], $cambio['valor']);
    }

    $writer = IOFactory::createWriter($spreadsheet, 'Xlsx');
    $writer->save($archivoExcel);

    echo "Cambios guardados con Ã©xito.";
} else {
    echo "No se recibieron datos.";
}
?>
